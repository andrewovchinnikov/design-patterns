# Python

<figure><img src="../../../../../.gitbook/assets/image (9).png" alt=""><figcaption><p>UML диаграмма для примера применения паттерна "Одиночка"</p></figcaption></figure>

Разработка веб-приложения с использованием базы данных. Для обеспечения эффективного доступа к данным и избежания конфликтов при работе с базой данных необходимо создать единственный экземпляр класса, отвечающего за работу с базой данных.

Решение:

Для решения этой задачи мы можем использовать паттерн "Одиночка" (Singleton) для создания единственного экземпляра класса, отвечающего за работу с базой данных. Этот экземпляр будет предоставлять доступ к базе данных и выполнять запросы к ней.

Например, для класса `Database`, отвечающего за работу с базой данных, паттерн "Одиночка" может быть реализован следующим образом на Python:

{% code overflow="wrap" lineNumbers="true" %}
```python
import sqlite3

class Database:
    _instance = None

    def __new__(cls, *args, **kwargs):
        if cls._instance is None:
            cls._instance = super().__new__(cls, *args, **kwargs)
            cls._instance.conn = sqlite3.connect("my_database.db")
        return cls._instance

    def query(self, query, args=()):
        cur = self.conn.cursor()
        cur.execute(query, args)
        return cur.fetchall()

    def __del__(self):
        self.conn.close()

#usage
db = Database()
users = db.query("SELECT * FROM users WHERE id = ?", (1,))
print(users)
```
{% endcode %}

В этом примере мы создаем класс `Database`, который отвечает за работу с базой данных. Мы используем паттерн "Одиночка" для создания единственного экземпляра класса `Database`.

Мы объявляем приватное статическое свойство `_instance`, которое будет хранить единственный экземплярр класса. Мы также переопределяем метод `__new__()`, который отвечает за создание экземпляров класса.

В методе `__new__()` мы проверяем, является ли переменная `_instance` равной `None`. Если да, то мы создаем новый экземплярр класса `Database` и сохраняем его в переменной `_instance`. В противном случае, мы просто возвращаем существующий экземплярр класса `Database`.

Метод `query()` используется для выполнения запросов к базе данных. Он принимает в качестве аргументов SQL-запрос и список параметров, и возвращает список кортежей с результатами запроса.
